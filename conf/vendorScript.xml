<?xml version="1.0"?>
<!-- $Id$ -->

<scripts xml:space="preserve" debug="true" id_prop="choice">
    <!--
    /**
     * Weapons
     */
    -->
    <script id="Weapons" noun="weapon">
        <intro>
            <ztats screen="weapons"/>
            <music type="shopping"/>
            WILLKOMMEN BEI {name}.

            {owner} SAGT: WILLKOMMEN <if test="{party:member1:sex}=f">FREUNDIN!</if><if test="{party:member1:sex}=m">FREUND!</if> WILLST DU KAUFEN ODER VERKAUFEN?<input type="choice" options="kv" target="buy_sell"/>
        </intro>

        <end>
            <music reset="true"/>
            <ztats screen="party"/>
        </end>

        <bye>
            {owner} SAGT: LEBE WOHL!
            <end/>
        </bye>

        <!--
        /**
         * Global items
         *
         * We list these here because you can sell
         * any weapon to any store, but each store
         * doesn't carry every weapon, so it needs
         * a global reference so it can figure out
         * how much gold to give you when you sell it
         */
         -->
        <weapon choice="b" name="STAB" price="20"/>
        <weapon choice="c" name="DOLCH" price="2"/>
        <weapon choice="d" name="SCHLEUDER" price="25"/>
        <weapon choice="e" name="STREITKOLBEN" price="100"/>
        <weapon choice="f" name="AXT" price="225"/>
        <weapon choice="g" name="SCHWERT" price="300"/>
        <weapon choice="h" name="BOGEN" price="250"/>
        <weapon choice="i" name="ARMBRUST" price="600"/>
        <weapon choice="j" name="BRAND\L" price="5"/>
        <weapon choice="k" name="HELLEBARDE" price="350"/>
        <weapon choice="l" name="MAG. AXT" price="1500"/>
        <weapon choice="m" name="MAG. SCHWERT" price="2500"/>
        <weapon choice="n" name="MAG. BOGEN" price="2000"/>
        <weapon choice="o" name="MAG. STAB" price="5000"/>
        <weapon choice="p" name="MYST. SCHWERT" price="7000"/>

        <buy_sell default="true" redirect="bye"/>

        <!--
        /**
         * Buying
         */
         -->

        <buy_more default="true" redirect="bye"/>
        <buy_more choice="j">
            <redirect target="buy_sell" choice="k"/>
        </buy_more>

        <buy_sell choice="k">
            SEHR GUT! WIR F]HREN:
            {show_inventory:show_item}
            DEIN WUNSCH?<input type="choice" options="{inventory_choices}" target="check_money"/>
        </buy_sell>

        <!-- what to show as the inventory for each item -->
        <show_item>{toupper({choice})}-{name}</show_item>

        <!-- check to see if the player has enough gold first -->
        <check_money choice="null" redirect="bye"/>
        <check_money>
            <context name="weapon"/> <!-- change the translation context with the $choice variable -->
            <var name="weapon" value="{$choice}"/>
            <var name="cost" value="{price}"/>
            <var name="quantity" value="1"/>

            <if test="{party:gold}&lt;{price}">
                DU HAST NICHT EINMAL DIE MITTEL F]R EIN EXEMPLAR!
                <redirect target="anything_else_buy"/>
            </if>

            <include script="tell_about" choice="{$choice}"/>
            <if test="{party:gold}&gt;={math({price}*2)}">
                <redirect target="howmany_buy"/>
            </if>
            ABGEMACHT?<input type="choice" options="jn" target="take_it"/>
        </check_money>

        <not_enough_money>
            ICH F]RCHTE DU HAST NICHT DIE MITTEL, VIELLEICHT ETWAS ANDERES.
            <redirect target="anything_else_buy"/>
        </not_enough_money>

        <take_it default="true" redirect="toobad"/>
        <take_it choice="j">
            <include script="buy"/> <!-- include the basic "buy" script -->
        </take_it>

        <!-- description of each weapon -->

        <tell_about choice="b">
            WIR SIND DIE EINZIGEN STABMACHER IN BRITANNIA, ABER VERKAUFEN SIE F]R NUR {price}gs.
        </tell_about>

        <tell_about choice="c">
            WIR VERKAUFEN DIE T\DLICHSTEN DOLCHE, GESCHENKT F]R NUR JE {price}gs.
        </tell_about>

        <tell_about choice="d">
            UNSERE SCHLEUDERN WERDEN NUR AUS BESTEM LEDER UND SCHNUR GEMACHT. F]R {price}gs IST EINE DEIN.
        </tell_about>

        <tell_about choice="e">
            DIESER STREITKOLBEN HAT EINEN GEH[RTETEN SCHAFT, UND SEIN KOPF WIEGT F]NF PFUND, {price}gs SIND EIN SPOTTPREIS.
        </tell_about>

        <tell_about choice="f">
            SIEHST DU DIE FEINE VERARBEITUNG DIESER AXT? DU WIRST MIR ZUSTIMMEN, DASS {price}gs EIN GUTER PREIS IST.
        </tell_about>

        <tell_about choice="g">
            DIE HERVORRAGENDE AUSF]HRUNG DIESES SCHWERTES WIRD DEINE FEINDE DAS F]RCHTEN LEHREN, F]R {price}gs.
        </tell_about>

        <tell_about choice="h">
            UNSER BOGEN IST AUS BESTER EIBE, UND DIE PFEILE AUS WEIDE. GERADEZU GESTOHLEN F]R {price}gs.
        </tell_about>

        <tell_about choice="i">
            EINE ARMBRUST VON IOLO DEM BARDEN, ER MACHT DIE BESTEN DER WELT. F]R {price}gs GEH\RT SIE DIR.
        </tell_about>

        <tell_about choice="j">
            \LAMPHOREN SIND HERVORRAGENDE WAFFEN UND ERZEUGEN EINE VERITABLE FLAMMENWAND. {price}gs PRO ST]CK.
        </tell_about>

        <tell_about choice="k">
            EINE HELLEBARDE IST EINE M[CHTIGE WAFFE, UM ]BER HINDERNISSE ANZUGREIFEN; EIN MUSS, UND NUR {price}gs.
        </tell_about>

        <tell_about choice="l">
            DIESE MAGISCHE AXT KANNST DU NACH DEINEM FEINDE WERFEN, SIE KEHRT ZUR]CK. DAS ALLES F]R {price}gs.
        </tell_about>

        <tell_about choice="m">
            MAGISCHE SCHWERTER WIE DIESES SIND WIRKLICH SELTEN. ICH TRENNE MICH DAVON F]R {price}gs.
        </tell_about>

        <tell_about choice="n">
            EIN MAGISCHER BOGEN H[LT DEINE FEINDE AUF ABSTAND - ODER TOT. EIN MUSS F]R {price}gs.
        </tell_about>

        <tell_about choice="o">
            DIESER MAGISCHE STAB ERZEUGT M[CHTIGE BLAUE BLITZE, UM DEINE FEINDE NIEDERZUSTRECKEN, {price}gs.
        </tell_about>

        <!-- input how many to buy -->
        <howmany_buy>
            WIE VIELE M\CHTEST DU?<input name="quantity" type="number" maxlen="2" target="buy"/>
        </howmany_buy>

        <!-- buy the weapon -->
        <buy choice="null" redirect="toobad"/>
        <buy>
            <if test="{$quantity}==0" redirect="anything_else_buy"/>
            <if test="{party:gold}&lt;{math({$quantity}*{price})}" redirect="not_enough_money"/>
            <pay price="{$cost}" quantity="{$quantity}" cantpay="check_money"/>
            <add type="weapon" subtype="{$weapon}" quantity="{$quantity}"/>
            {owner} SAGT: EINE GUTE WAHL!
            <redirect target="anything_else_buy"/>
        </buy>

        <toobad>
            SCHADE.
            <redirect target="anything_else_buy"/>
        </toobad>

        <anything_else_buy>
            <unset_context/>
            NOCH ETWAS?<input type="choice" options="jn" target="buy_more"/>
        </anything_else_buy>

        <!--
        /**
         * Selling
         */
         -->
        <buy_sell choice="v">
            EXZELLENT! WELCHE M\CHTEST DU VERKAUFEN?
            <redirect target="you_sell"/>
        </buy_sell>

        <you_sell choice="null" redirect="bye"/>
        <you_sell>
            VERKAUFE: <input type="choice" options="bcdefghijklmnop" target="sell_weapon"/>
        </you_sell>

        <sell_weapon choice="null" redirect="bye"/>
        <sell_weapon>
            <context name="weapon"/> <!-- Add the weapon we're talking about to the translation context -->
            <var name="weapon" value="{$choice}"/>
            <var name="price" value="{math({price}/2)}"/>
            <if test="{party:weapon:{name}}==0" redirect="you_sell"/>
            <if test="{party:weapon:{name}}&gt;1" redirect="sell_many"/>
            <redirect target="sell_one"/>
        </sell_weapon>

        <!-- sell just one item -->
        <sell_one>
            <var name="quantity" value="1"/>
            ICH GEBE DIR {$price}gs DAF]R. ABGEMACHT?<input type="choice" options="jn" target="sell"/>
        </sell_one>

        <sell_many>
            WIE VIELE DAVON M\CHTEST DU VERKAUFEN?<input name="quantity" type="number" maxlen="2" target="sell_many_offer"/>
        </sell_many>

        <sell_many_offer choice="null" redirect="bye"/>
        <sell_many_offer>
            <if test="{$quantity}==0" redirect="sell" choice="n"/>
            <if test="{$quantity}&gt;{party:weapon:{name}}" redirect="dont_have_that_many"/>
            ICH GEBE DIR {math({$price}*{$quantity})}gs DAF]R. ABGEMACHT?<input type="choice" options="jn" target="sell"/>
        </sell_many_offer>

        <dont_have_that_many>
            DU HAST NICHT SO VIELE, SCHWEIN!
            <end/>
        </dont_have_that_many>

        <sell default="true" redirect="bye"/>
        <sell choice="n">
            HMMPF. WAS WILLST DU NOCH VERKAUFEN?
            <redirect target="you_sell"/>
        </sell>
        <sell choice="j">
            <lose type="weapon" subtype="{$weapon}" quantity="{$quantity}"/>
            <add type="gold" quantity="{math({$quantity}*{$price})}"/>
            <unset_context/>
            HERVORRAGEND! WAS SONST NOCH?
            <redirect target="you_sell"/>
        </sell>

        <vendor id="BRITAIN" name="DER WINDSOR WAFFENSCHMIEDE" owner="WINSTON">
            <weapon choice="b" name="STAB" price="20"/>
            <weapon choice="c" name="DOLCH" price="2"/>
            <weapon choice="d" name="SCHLEUDER" price="25"/>
            <weapon choice="g" name="SCHWERT" price="300"/>
        </vendor>

        <vendor id="JHELOM" name="WILLARDS WAFFENSCHMIEDE" owner="WILLARD">
            <weapon choice="f" name="AXT" price="225"/>
            <weapon choice="g" name="SCHWERT" price="300"/>
            <weapon choice="i" name="ARMBRUST" price="600"/>
            <weapon choice="k" name="HELLEBARDE" price="350"/>
        </vendor>

        <vendor id="MINOC" name="DEN EISENWERKEN" owner="PETER">
            <weapon choice="e" name="STREITKOLBEN" price="100"/>
            <weapon choice="k" name="HELLEBARDE" price="300"/>
            <weapon choice="l" name="MAG. AXT" price="1500"/>
            <weapon choice="m" name="MAG. SCHWERT" price="2500"/>
        </vendor>

        <vendor id="TRINSIC" name="DEN DUELL-ARTIKELN" owner="JUMAR">
            <weapon choice="e" name="STREITKOLBEN" price="100"/>
            <weapon choice="f" name="AXT" price="225"/>
            <weapon choice="g" name="SCHWERT" price="300"/>
            <weapon choice="h" name="BOGEN" price="250"/>
        </vendor>

        <vendor id="BUKANIER-NEST" name="HOOKS WEHR" owner="HOOK">
            <weapon choice="i" name="ARMBRUST" price="600"/>
            <weapon choice="j" name="BRAND\L" price="5"/>
            <weapon choice="n" name="MAG. BOGEN" price="2000"/>
            <weapon choice="o" name="MAG. STAB" price="5000"/>
        </vendor>

        <vendor id="VESPER" name="DES D\RFLERS WEHR" owner="WENDY">
            <weapon choice="c" name="DOLCH" price="2"/>
            <weapon choice="d" name="SCHLEUDER" price="25"/>
            <weapon choice="h" name="BOGEN" price="250"/>
            <weapon choice="j" name="BRAND\L" price="5"/>
        </vendor>

    </script>

    <!--
    /**
     * Armor
     */
    -->
    <script id="Armor" noun="armor">
        <intro>
            <ztats screen="armor"/>
            <music type="shopping"/>
            WILLKOMMEN BEI {name}

            {owner} SAGT: WILLKOMMEN <if test="{party:member1:sex}=f">FREUNDIN!</if><if test="{party:member1:sex}=m">FREUND!</if> WILLST DU KAUFEN ODER VERKAUFEN?<input type="choice" options="kv" target="buy_sell"/>
        </intro>

        <end>
            <music reset="true"/>
            <ztats screen="party"/>
        </end>

        <bye>
            {owner} SAGT: ADE.
            <end/>
        </bye>

       <!--
        /**
         * Global items
         *
         * We list these here because you can sell
         * any weapon to any store, but each store
         * doesn't carry every weapon, so it needs
         * a global reference so it can figure out
         * how much gold to give you when you sell it
         */
         -->
        <armor choice="b" name="TUCH" price="50"/>
        <armor choice="c" name="LEDER" price="200"/>
        <armor choice="d" name="KETTE" price="600"/>
        <armor choice="e" name="PLATTE" price="2000"/>
        <armor choice="f" name="MAG. KETTE" price="4000"/>
        <armor choice="g" name="MAG. PLATTE" price="7000"/>
        <armor choice="h" name="MYST. ROBE" price="9000"/>

        <buy_sell default="true" redirect="bye"/>

        <!--
        /**
         * Buying
         */
         -->

        <buy_more default="true" redirect="bye"/>
        <buy_more choice="j">
            <redirect target="buy_sell" choice="k"/>
        </buy_more>

        <buy_sell choice="k">
            NUN DANN, WIR HABEN:
            {show_inventory:show_item}

            WAS SOLL ES SEIN?<input type="choice" options="{inventory_choices}" target="check_money"/>
        </buy_sell>

        <!-- what to show as the inventory for each item -->
        <show_item>{toupper({choice})}-{name}</show_item>

        <!-- check to see if the player has enough gold first -->
        <check_money choice="null" redirect="bye"/>
        <check_money>
            <context name="armor"/>
            <var name="armor" value="{$choice}"/>
            <var name="quantity" value="1"/>

            <if test="{party:gold}&lt;{price}">
                DU HAST NICHT EINMAL DIE MITTEL F]R EIN EXEMPLAR!
                <redirect target="anything_else_buy"/>
            </if>

            <include script="tell_about" choice="{$choice}"/>
            <if test="{party:gold}&gt;={math({price}*2)}">
                <redirect target="howmany_buy"/>
            </if>
            ABGEMACHT?<input type="choice" options="jn" target="take_it"/>
        </check_money>

        <not_enough_money>
            DU HAST NICHT GENUG GOLD. VIELLEICHT ETWAS G]NSTIGERES?
            <redirect target="anything_else_buy"/>
        </not_enough_money>

        <take_it default="true" redirect="toobad"/>
        <take_it choice="j">
            <include script="buy"/> <!-- include the basic "buy" script -->
        </take_it>

        <!-- description of each armor -->

        <tell_about choice="b">
            TUCHR]STUNG IST GUT F]R EIN ENGES BUDGET, ZUM FAIREN PREISE VON {price}gs.
        </tell_about>

        <tell_about choice="c">
            LEDERR]STUNG IST EBENSO GESCHMEIDIG WIE FEST, UND KOSTET LAUSIGE {price}gs. EIN SCHN[PPCHEN!
        </tell_about>

        <tell_about choice="d">
            KETTENR]STUNG WIRD VON MEHR KRIEGERN GETRAGEN ALS JEDE ANDERE ART. UNSERE KOSTET {price}gs.
        </tell_about>

        <tell_about choice="e">
            VOLLE PLATTENR]STUNG IST DAS NONPLUSULTRA DER NICHT-MAGISCHEN R]STUNGEN. ERHALTE DEINE F]R {price}gs.
        </tell_about>

        <tell_about choice="f">
            MAGISCHE R]STUNG IST SELTEN UND TEUER. DIESES KETTENHEMD WIRD F]R {price}gs VERKAUFT.
        </tell_about>

        <tell_about choice="g">
            MAGISCHE PLATTENR]STUNG IST DER BESTE BEKANNTE SCHUTZ. NUR WIR HABEN SIE. KOSTEN: {price}gs.
        </tell_about>

        <!-- input how many to buy -->
        <howmany_buy>
            WIE VIELE WILLST DU?<input name="quantity" type="number" target="buy"/>
        </howmany_buy>

        <!-- buy the armor -->
        <buy choice="null" redirect="toobad"/>
        <buy>
            <if test="{$quantity}==0" redirect="anything_else_buy"/>
            <if test="{party:gold}&lt;{math({$quantity}*{price})}" redirect="not_enough_money"/>
            <pay price="{price}" quantity="{$quantity}" cantpay="check_money"/>
            <add type="armor" subtype="{$armor}" quantity="{$quantity}"/>
            {owner} SAGT: GUTE WAHL!
            <redirect target="anything_else_buy"/>
        </buy>

        <toobad>
            SCHADE.
            <redirect target="anything_else_buy"/>
        </toobad>

        <anything_else_buy>
            <unset_context/>
            NOCH ETWAS ANDERES?<input type="choice" options="jn" target="buy_more"/>
        </anything_else_buy>

        <!--
        /**
         * Selling
         */
         -->
        <buy_sell choice="v">
            WAS WILLST DU <redirect target="you_sell"/>
        </buy_sell>

        <you_sell>
            VERKAUFEN: <input type="choice" options="bcdefgh" target="sell_armor"/>
        </you_sell>

        <sell_armor choice="null" redirect="bye"/>
        <sell_armor>
            <context name="armor"/>
            <var name="armor" value="{$choice}"/>
            <var name="price" value="{math({price}/2)}"/>

            <if test="{party:armor:{name}}==0">
                KOMM SCHON, DAS BESITZT DU NICHT.
                <redirect target="bye"/>
            </if>

            <if test="{party:armor:{name}}&gt;1" redirect="sell_many"/>
            <redirect target="sell_one"/>
        </sell_armor>

        <!-- sell just one item -->
        <sell_one>
            <var name="quantity" value="1"/>
            ICH GEBE DIR {$price}gs DAF]R. ABGEMACHT?<input type="choice" options="jn" target="sell"/>
        </sell_one>

        <sell_many>
            WIE VIELE DAVON W]RDEST DU VERKAUFEN WOLLEN?<input name="quantity" type="number" target="sell_many_offer"/>
        </sell_many>

        <sell_many_offer choice="null" redirect="bye"/>
        <sell_many_offer>
            <if test="{$quantity}==0" redirect="sell" choice="n"/>
            <var name="price" value="{math({$price}*{$quantity})}"/>
            <if test="{$quantity}&gt;{party:armor:{name}}" redirect="dont_have_that_many"/>
            ICH GEBE DIR {$price}gs DAF]R. ABGEMACHT?<input type="choice" options="jn" target="sell"/>
        </sell_many_offer>

        <dont_have_that_many>
            DU HAST NICHT SO VIELE, SCHWEIN!
            <end/>
        </dont_have_that_many>

        <sell default="true" redirect="bye"/>
        <sell choice="n">
            <unset_context/>
            HARUMPF. WAS WILLST DU NOCH <redirect target="you_sell"/>
        </sell>
        <sell choice="j">
            <lose type="armor" subtype="{$armor}" quantity="{$quantity}"/>
            <add type="gold" quantity="{$price}"/>
            <unset_context/>
            SCH\N! WAS NOCH <redirect target="you_sell"/>
        </sell>

        <vendor id="BRITAIN" name="WINDSOR SCHUTZMACHEREI." owner="WINSTON">
            <armor choice="b" name="TUCH" price="50"/>
            <armor choice="c" name="LEDER" price="200"/>
            <armor choice="d" name="KETTE" price="600"/>
        </vendor>

        <vendor id="JHELOM" name="VALIANTS SCHUTZMACHEREI." owner="VALIANT">
            <armor choice="d" name="KETTE" price="600"/>
            <armor choice="e" name="PLATTE" price="2000"/>
            <armor choice="f" name="MAG. KETTE" price="4000"/>
            <armor choice="g" name="MAG. PLATTE" price="7000"/>
        </vendor>

        <vendor id="TRINSIC" name="DER DECKUNG GMBH &amp; CO. KG!" owner="JEAN">
            <armor choice="b" name="TUCH" price="50"/>
            <armor choice="d" name="KETTE" price="600"/>
            <armor choice="f" name="MAG. KETTE" price="4000"/>
        </vendor>

        <vendor id="PFOTEN" name="LEICHTSCHUTZ." owner="PIERRE">
            <armor choice="b" name="TUCH" price="50"/>
            <armor choice="c" name="LEDER" price="200"/>
        </vendor>

        <vendor id="BUKANIER-NEST" name="DEM EINFACHEN SCHUTZE." owner="LIMPY">
            <armor choice="b" name="TUCH" price="50"/>
            <armor choice="c" name="LEDER" price="200"/>
            <armor choice="d" name="KETTE" price="600"/>
        </vendor>

    </script>

    <!--
    /**
     * Food
     */
    -->
    <script id="Food">
        <intro>
            <music type="shopping"/>
            WILLKOMMEN BEI{name}.

            {owner} SAGT: GUTEN TAG, UND WILLKOMMEN, <if test="{party:member1:sex}=f">FREUNDIN.
            </if><if test="{party:member1:sex}=m">FREUND.
            </if><if test="{party:gold}&lt;{price}" redirect="come_back"/>
            BIST DU AN LEBENSMITTELN INTERESSIERT?<input type="choice" options="jn" target="ask"/>
        </intro>

        <end>
            <music reset="true"/>
        </end>

        <ask default="true" redirect="bye"/>
        <ask choice="j">
            WIR HABEN DIE BESTEN RATIONEN F]R ABENTEUER, {quant} F]R NUR {price}gs.
            <redirect target="howmany"/>
        </ask>
        <howmany>WIE VIELE PAKETE ZU JE {quant} M\CHTEST DU?<input name="quantity" type="number" target="buy"/></howmany>
        <buy choice="null">
            SEHR SCHADE. VIELLEICHT BEIM N[CHSTEN MALE.
            <redirect target="bye"/>
        </buy>
        <buy>
            <pay price="{price}" quantity="{$quantity}" cantpay="cantpay"/>
            <add type="food" quantity="{math({quant}*{$quantity})}"/>
            DANKE.<if test="{party:gold}&lt;{price}" redirect="come_again"/>
            NOCH ETWAS?<input type="choice" options="jn" target="ask"/>
        </buy>
        <cantpay>
            DU KANNST DIR NUR {math({party:gold}/{price})} PAKETE LEISTEN.
            <redirect target="howmany"/>
        </cantpay>
        <come_back>
            <wait_for_keypress/>
            KOMM WIEDER, WENN DU ETWAS GELD HAST!
            <end/>
        </come_back>
        <come_again>
            KOMM WIEDER VORBEI!
            <end/>
        </come_again>
        <bye>
            ADE. KOMM WIEDER VORBEI!
            <end/>
        </bye>

        <vendor id="GLIMMEMOND" name=" DEN WEISEN DELIKATESSEN" owner="SHAMAN" price="25" quant="25"/>
        <vendor id="BRITAIN" name=" ABENTEUER-KOST" owner="WINDRICK" price="40" quant="25"/>
        <vendor id="EIBE" name=" DEN TROCKENWAREN" owner="DONNAR" price="35" quant="25"/>
        <vendor id="SKARA BRAE" name=" GANZ SCH\N WAS ZU KNABBBERN" owner="MINTOL" price="20" quant="25"/>
        <vendor id="PFOTEN" name="M DISCOUNTER" owner="MAX" price="30" quant="25"/>
    </script>

    <!--
    /**
     * Taverns
     */
    -->
    <script id="Tavern">
        <intro>
            <music type="shopping"/>
            {owner} SAGT: WILLKOMMEN {name}.<redirect target="whatll_it_be"/>
        </intro>

        <end>
            <music reset="true"/>
        </end>

        <ask default="true" redirect="bye"/>
        <ask choice="j" redirect="whatll_it_be"/>
        <whatll_it_be>

            {owner} SAGT: WAS SOLL'S DENN SEIN, WAS ZU FUTTERN ODER 'N BIER?<input type="choice" options="fb" target="buy"/>
        </whatll_it_be>

        <bye>
            BIS BALD, <if test="{party:member1:sex}=m">KUMPEL!
            </if><if test="{party:member1:sex}=f">LADY!
            </if>
            <end/>
        </bye>

        <buy default="true" redirect="bye"/>
        <buy choice="f">
            UNSERE SPEZIALIT[T IST {specialty}, KOSTET {spec_price}gs. <redirect target="how_many_plates"/>
        </buy>

        <how_many_plates>WIE VIELE TELLER DAVON SOLL ICH BRINGEN?<input name="quantity" type="number" target="food_buy"/>
        </how_many_plates>

        <food_buy choice="null" redirect="bye"/>
        <food_buy>
            <if test="{$quantity}==0" redirect="bye"/>
            <pay price="{spec_price}" quantity="{$quantity}" cantpay="cantpay_food"/>
            BITTESCH\N.
            <add type="food" quantity="{$quantity}"/>
            <redirect target="something_else"/>
        </food_buy>

        <cantpay_food>
            <if test="{math({party:gold}/{spec_price})}==0" redirect="cantpay_ale"/>
            MENSCH, DU KANNST DIR DOCH NUR {math({party:gold}/{spec_price})} TELLER LEISTEN.

            <redirect target="how_many_plates"/>
        </cantpay_food>

        <something_else>
            NOCH WAS ANDERES?<input type="choice" options="jn" target="ask"/>
        </something_else>

        <buy choice="b">
            HIER HAST'N HUMPEN VOM BESTEN. DAS MACHT DANN {ale_price}gs.

            Du Zahlst-<input name="price" type="number" maxlen="2" target="ale_buy"/>
        </buy>

        <ale_buy choice="null" redirect="bye"/>
        <ale_buy>
            <if test="{$price}&lt;{ale_price}">
                WILLST NICH ZAHLEN, HE? ABSCHAUM, ZIEH LEINE 'VOR ICH DIE WACHEN RUFE!
                <end/>
            </if>
            <pay price="{$price}" quantity="1" cantpay="cantpay_ale"/>
            <if test="{$price}={ale_price}" redirect="something_else"/>
            <if test="{$price}&gt;{ale_price}">
                <var name="tip_total" value="{math({$price}-{ale_price})}"/>
                WAS WILLST'N WISSSEN, <if test="{party:member1:sex}=f">MEINE FREUNDIN?
                </if><if test="{party:member1:sex}=m">MEIN FREUND?
                </if>
                <input name="choice" type="text" target="topic"/>
            </if>
        </ale_buy>

        <cantpay_ale>
          WIE'S SCHEINT HASTE KEINE KOHLE. GUTEN TAG!
          <end/>
        </cantpay_ale>

        <topic default="true">
            <if test="{isempty({$choice})}" redirect="something_else"/>
            F]RCHTE, ICH KANN DIR DA NICHT HELFEN, <if test="{party:member1:sex}=f">MEINE FREUNDIN!
            </if><if test="{party:member1:sex}=m">MEIN FREUND!
            </if>
            <redirect target="something_else"/>
        </topic>

        <reply choice="schwa">
            {owner} SAGT: ACH, DER SCHWARZE STEIN. JA, SCHON MAL VON GEH\RT. ABER DER EINZIGE, DER WEISS, WO ER LIEGT, IST DER ZAUBERER MERLIN.
            <redirect target="something_else"/>
        </reply>

        <reply choice="sexta">
            {owner} SAGT: BEIM NAVIGIEREN IST 'N SEXTANT LEBENSWICHTIG... FRAG IN DEN GILDENL[DEN NACH GEGENSTAND "D"!
            <redirect target="something_else"/>
        </reply>

        <reply choice="weiss">
            LASS MICH ]BERLEGEN... JA, 'S WAR DIESER ALTE EREMIT... SLOVEN! SCHWER ZU FINDEN, LEBT BEIM LOCH-SEE WIE MAN H\RT.
            <redirect target="something_else"/>
        </reply>

        <reply choice="alrau">
            {owner} SAGT: DER LETZTE, VON DEM ICH WEISS, DASS ER NOCH ALRAUNE HATTE, WAR SO'N ALTER ALCHIMIST NAMENS CALUMNY.
            <redirect target="something_else"/>
        </reply>

        <reply choice="schae">
            {owner} SAGT: WENN DU DENN VON DIESEM B\SESTEN ALLER DINGE WISSEN MUSST... FINDE DEN BETTLER JUDE. ER IST SEHR, SEHR ARM!
            <redirect target="something_else"/>
        </reply>

        <reply choice="schat">
            {owner} SAGT: VON SCHATTEN WEISS ICH NUR SOVIEL... FRAG VIRGIL, SONST FIND'STE KEINEN STIEL. VERSUCH'S IN TRINSIC!
            <redirect target="something_else"/>
        </reply>

        <save>
            <context name="topic"/>
            <var name="topic" value="{$choice}"/>
            <var name="payment" value="0"/>
            <redirect target="foggy"/>
        </save>

        <sorry>
            TUT MIR LEID, DABEI K\NNT' ICH DIR NICHT HELFEN, <if test="{party:member1:sex}=m">KUMPEL!
            </if><if test="{party:member1:sex}=f">LADY!
            </if>
            <redirect target="something_else"/>
        </sorry>

        <foggy choice="null" redirect="sorry"/>
        <foggy>
            <pay price="{$payment}" quantity="1" cantpay="cantpay_topic"/>
            <var name="tip_total" value="{math({$tip_total}+{$payment})}"/>
            <if test="{price}&lt;={$tip_total}" choice="{$topic}" redirect="reply"/>
            DAS THEMA IST GERADE 'N BISSCHEN TR]BE, VIELLEICHT ERFRISCHT MEHR GOLD JA MEIN GED[CHTNIS.

            Du gibst-<input name="payment" type="number" maxlen="2"/>
            <if test="{$payment}==0" redirect="sorry"/>
                <redirect target="foggy"/>
        </foggy>

        <cantpay_topic>
            SOVIEL HAST DU DOCH GAR NICHT, <if test="{party:member1:sex}=m">KUMPEL!
            </if><if test="{party:member1:sex}=f">LADY!
            </if>
            <redirect target="sorry"/>
        </cantpay_topic>

        <vendor id="BRITAIN" name="BEI DEN LAUNIGEN GEISTERN" owner="SAM" specialty="LAMMKOTLETTS" spec_price="4" ale_price="2">
            <topic choice="schwa" price="20" redirect="save"/>
        </vendor>

        <vendor id="JHELOM" name="IN DER BLUTIGEN PINTE" owner="CELESTIAL" specialty="DRACHENTARTAR" spec_price="2" ale_price="2">
            <topic choice="sexta" price="30" redirect="save"/>
        </vendor>

        <vendor id="TRINSIC" name="IM ZAPFHAHNE" owner="TERRAN" specialty="BRAUNE BOHNEN" spec_price="3" ale_price="2">
            <topic choice="weiss" price="10" redirect="save"/>
        </vendor>

        <vendor id="PFOTEN" name="IN FOLLEYS KNEIPE" owner="GREG &amp; ROB" specialty="FOLLEY-FILET" spec_price="2" ale_price="2">
            <topic choice="alrau" price="40" redirect="save"/>
        </vendor>

        <vendor id="BUKANIER-NEST" name="IN DER SPELUNKE ZUM KORSAREN" owner="DER C[P'N" specialty="HUNDEPASTETE" spec_price="4" ale_price="2">
            <topic choice="schae" price="99" redirect="save"/>
        </vendor>

        <vendor id="VESPER" name="IM AXT &amp; ALE" owner="ARRON" specialty="GR]NER GRANUKIT" spec_price="2" ale_price="2">
            <topic choice="schat" price="25" redirect="save"/>
        </vendor>
    </script>

    <!--
    /**
     * Reagents
     */
     -->

    <script id="Reagents" noun="reagent">
        <intro>
            <music type="shopping"/>
            <ztats screen="reagents"/>
            EINE BLINDE FRAU DREHT SICH ZU DIR UM UND SAGT: WILKOMMEN BEI{name}.

            ICH BIN {owner}. BRAUCHST DU REAGENZIEN?<input type="choice" options="jn" target="show_reagents"/>
        </intro>

        <end>
            <music reset="true"/>
            <ztats screen="party"/>
        </end>

        <bye>
            {owner} SAGT: DANN VIELLEICHT EIN ANDERNMAL... UND DREHT SICH LANGSAM WEG.
            <end/>
        </bye>

        <show_reagents default="true" redirect="bye"/>
        <show_reagents choice="j">
            SEHR SCH\N,
            ICH HABE
            {show_inventory:show_item}
            DEIN WUNSCH:<input type="choice" options="{inventory_choices}" target="how_many"/>
        </show_reagents>

        <show_item>{toupper({choice})}-{name}</show_item>

        <how_many choice="null" redirect="bye"/>
        <how_many>
            <context name="reagent"/>
            <var name="reagent" value="{$choice}"/>
            SEHR SCH\N,
            WIR VERKAUFEN
            {name}
            F]R {price}gs.

            WIE VIELE
            M\CHSTEST DU,
            (0-9)?<input name="quantity" type="number" maxlen="1" target="that_makes"/>
        </how_many>

        <i_see_then>
            ICH VERSTEHE, DANN<redirect target="anything_else"/>
        </i_see_then>

        <anything_else>
            <unset_context/>
            NOCH ETWAS?<input type="choice" options="jn" target="show_reagents"/>
        </anything_else>

        <that_makes choice="null" redirect="i_see_then"/>
        <that_makes>
            <if test="{$quantity}==0" redirect="i_see_then"/>
            SEHR SCH\N, DAS MACHT DANN {math({price}*{$quantity})}gs.<redirect target="you_pay"/>
        </that_makes>

        <you_pay>
            DU ZAHLST:<input name="price" type="number" maxlen="2" target="buy"/>
        </you_pay>

        <buy choice="null" redirect="i_see_then"/>
        <buy>
            <if test="{$price}==0" redirect="gold_drop"/>
            <pay price="{$price}" quantity="1" cantpay="cantpay"/>
            <add type="reagent" subtype="{type}" quantity="{$quantity}"/>
            SEHR SCH\N.<if test="{$price}&lt;{math({price}*{$quantity})}">
                         <karma action="cheated_merchant"/>
                         <redirect target="anything_else"/>
                     </if>
            <karma action="honest_to_merchant"/>
            <redirect target="anything_else"/>
        </buy>

        <cantpay>
            ES SCHEINT, DU HAST NICHT SO VIEL!<redirect target="anything_else"/>
        </cantpay>

        <gold_drop>
            KOMM SCHON, LASS MICH DAS GOLD FALLEN H\REN!<redirect target="you_pay"/>
        </gold_drop>

        <vendor id="GLIMMEMOND" name="M MAGISCHEN KRAUTE" owner="MARGOT">
            <reagent choice="a" name="SCHWELASCHE" type="ash" price="2"/>
            <reagent choice="b" name="GINSENG" type="ginseng" price="5"/>
            <reagent choice="c" name="KNOBLAUCH" type="garlic" price="6"/>
            <reagent choice="d" name="SPINNWEBEN" type="silk" price="3"/>
            <reagent choice="e" name="BLUTMOOS" type="moss" price="6"/>
            <reagent choice="f" name="SCHWARZPERL" type="pearl" price="9"/>
        </vendor>

        <vendor id="SKARA BRAE" name=" KRAUT UND GEW]RZ" owner="SASHA">
            <reagent choice="a" name="SCHWELASCHE" type="ash" price="2"/>
            <reagent choice="b" name="GINSENG" type="ginseng" price="4"/>
            <reagent choice="c" name="KNOBLAUCH" type="garlic" price="9"/>
            <reagent choice="d" name="SPINNWEBEN" type="silk" price="6"/>
            <reagent choice="e" name="BLUTMOOS" type="moss" price="4"/>
            <reagent choice="f" name="SCHWARZPERL" type="pearl" price="8"/>
        </vendor>

        <vendor id="PFOTEN" name=" MAGICK" owner="SHEILA">
            <reagent choice="a" name="SCHWELASCHE" type="ash" price="3"/>
            <reagent choice="b" name="GINSENG" type="ginseng" price="4"/>
            <reagent choice="c" name="KNOBLAUCH" type="garlic" price="2"/>
            <reagent choice="d" name="SPINNWEBEN" type="silk" price="9"/>
            <reagent choice="e" name="BLUTMOOS" type="moss" price="6"/>
            <reagent choice="f" name="SCHWARZPERL" type="pearl" price="7"/>
        </vendor>

        <vendor id="BUKANIER-NEST" name="M MAGISCHEN MENTAR" owner="SHANNON">
            <reagent choice="a" name="SCHWELASCHE" type="ash" price="6"/>
            <reagent choice="b" name="GINSENG" type="ginseng" price="7"/>
            <reagent choice="c" name="KNOBLAUCH" type="garlic" price="9"/>
            <reagent choice="d" name="SPINNWEBEN" type="silk" price="9"/>
            <reagent choice="e" name="BLUTMOOS" type="moss" price="9"/>
            <reagent choice="f" name="SCHWARZPERL" type="pearl" price="1"/>
        </vendor>
    </script>

    <!--
    /**
     * Healer
     */
     -->

    <script id="Healer" noun="service">
        <intro>
            <music type="shopping"/>
            WILKOMMEN BEI{name}.

            {healer} SAGT: FRIEDE UND FREUDE SEI MIT DIR, <if test="{party:member1:sex}=f">FREUNDIN.</if><if test="{party:member1:sex}=m">FREUND.</if> BEN\TIGST DU HILFE?<input type="choice" options="jn" target="show_services"/>
        </intro>

        <end>
            <music reset="true"/>
        </end>

        <bye>
            {healer} SAGT: M\GE DEIN LEBEN BESCHIRMT SEIN VON DEN M[CHTEN DES GUTEN.
            <end/>
        </bye>

        <give_blood>
            <if test="{party:member1:hp}&gt;=400">
                BIST DU GEWILLT, 100 PUNKTE VON DEINEM BLUTE ZU GEBEN, UM ANDEREN ZU HELFEN?<input type="choice" options="jn" target="gave_blood"/>
            </if>
            <redirect target="bye"/>
        </give_blood>

        <gave_blood default="true" redirect="bye"/>
        <gave_blood choice="n">
            <karma action="didnt_give_blood"/>
            <redirect target="bye"/>
        </gave_blood>
        <gave_blood choice="j">
            <damage player="1" pts="100"/>
            <karma action="gave_blood"/>
            DU BIST EINE GROSSE HILFE. WIR HABEN DRINGENDEN BEDARF!<wait_for_keypress/><redirect target="bye"/>
        </gave_blood>

        <more_help>
            <unset_context/>
            {healer} FRAGT: BRAUCHST DU NOCH MEHR HILFE?<input type="choice" options="jn" target="show_services"/>
        </more_help>

        <show_services default="true" redirect="give_blood"/>
        <show_services choice="j">
            {healer} SAGT: WIR TUN FOLGENDES:

            {show_inventory:show_item}

            Dein Bedarf-<input type="choice" options="{inventory_choices}" target="who_needs"/>
        </show_services>

        <show_item>{toupper({choice})}-{name}</show_item>

        <who_needs choice="null" redirect="give_blood"/>
        <who_needs>
            <context name="service"/>
            <var name="service" value="{$choice}"/>
            <var name="choice" value="1"/>
            {healer} FRAGT: WER HAT BEDARF?<input name="choice" type="player" target="will_pay"/>
        </who_needs>

        <will_pay choice="null">
            NIEMAND?
            <redirect target="more_help"/>
        </will_pay>

        <will_pay>
            <var name="player" value="{$choice}"/>
            <if test="!{party:member{$player}:needs:{type}}">
                <include script="dont_need" choice="{$service}"/>
                <redirect target="more_help"/>
            </if>
            {desc} KOSTET DICH {price}gs.
            <if test="{party:gold}&lt;{price}">
              <if test="{type}=cure">
                ICH SEHE AN DEINER B\RSE, DASS DU NICHT GENUG GOLD HAST.<wait_for_keypress/>ICH WERDE DICH KOSTENLOS KURIEREN, ABER GIB ANDEREN, WANN IMMER DU KANNST!<wait_for_keypress/>
                <cast_spell/>
                <heal type="cure" player="{$player}"/>

                <redirect target="more_help"/>
              </if>
              ICH SEHE AN DEINER B\RSE, DASS DU NICHT GENUG GOLD HAST. ICH KANN DIR NICHT HELFEN.<wait_for_keypress/><redirect target="more_help"/>
            </if>
            WILLST DU DAS BEZAHLEN?<input type="choice" options="jn" target="heal"/>
        </will_pay>

        <heal default="true" redirect="more_help"/>
        <heal choice="j">
            <pay price="{price}" quantity="1"/>
            <cast_spell/>
            <heal type="{type}" player="{$player}"/>

            <redirect target="more_help"/>
        </heal>

        <dont_need choice="a">
            DU LEIDEST NICHT UNTER VERGIFTUNG!
        </dont_need>
        <dont_need choice="b">
            DU BIST SCHON GANZ GESUND!
        </dont_need>
        <dont_need choice="c">
            DU BIST NICHT TOT, NARR!
        </dont_need>
        <vendor id="BRITANNIA" name=" DES K\NIGS HEILER" healer="PENDRAGON">
            <service choice="a" name="GIFT KURIEREN" desc="EINE ENTGIFTUNG" price="100" type="cure"/>
            <service choice="b" name="WUNDEN HEILEN" desc="EINE WUNDHEILUNG" price="200" type="fullheal"/>
            <service choice="c" name="TOTE ERWECKEN" desc="EINE ERWECKUNG" price="300" type="resurrect"/>
        </vendor>

        <vendor id="GLIMMEMOND" name="M HEILER" healer="HARMONY">
            <service choice="a" name="GIFT KURIEREN" desc="EINE ENTGIFTUNG" price="100" type="cure"/>
            <service choice="b" name="WUNDEN HEILEN" desc="EINE WUNDHEILUNG" price="200" type="fullheal"/>
            <service choice="c" name="TOTE ERWECKEN" desc="EINE ERWECKUNG" price="300" type="resurrect"/>
        </vendor>

        <vendor id="BRITAIN" name="M WUNDHEILER" healer="CELEST">
            <service choice="a" name="GIFT KURIEREN" desc="EINE ENTGIFTUNG" price="100" type="cure"/>
            <service choice="b" name="WUNDEN HEILEN" desc="EINE WUNDHEILUNG" price="200" type="fullheal"/>
            <service choice="c" name="TOTE ERWECKEN" desc="EINE ERWECKUNG" price="300" type="resurrect"/>
        </vendor>

        <vendor id="JHELOM" name=" HEIL UND GESUND" healer="TRIPLET">
            <service choice="a" name="GIFT KURIEREN" desc="EINE ENTGIFTUNG" price="100" type="cure"/>
            <service choice="b" name="WUNDEN HEILEN" desc="EINE WUNDHEILUNG" price="200" type="fullheal"/>
            <service choice="c" name="TOTE ERWECKEN" desc="EINE ERWECKUNG" price="300" type="resurrect"/>
        </vendor>

        <vendor id="EIBE" name=" RECHTE HEILUNG" healer="JUSTIN">
            <service choice="a" name="GIFT KURIEREN" desc="EINE ENTGIFTUNG" price="100" type="cure"/>
            <service choice="b" name="WUNDEN HEILEN" desc="EINE WUNDHEILUNG" price="200" type="fullheal"/>
            <service choice="c" name="TOTE ERWECKEN" desc="EINE ERWECKUNG" price="300" type="resurrect"/>
        </vendor>

        <vendor id="SKARA BRAE" name="M MYSTISCHEN HEILE" healer="SPIRAN">
            <service choice="a" name="GIFT KURIEREN" desc="EINE ENTGIFTUNG" price="100" type="cure"/>
            <service choice="b" name="WUNDEN HEILEN" desc="EINE WUNDHEILUNG" price="200" type="fullheal"/>
            <service choice="c" name="TOTE ERWECKEN" desc="EINE ERWECKUNG" price="300" type="resurrect"/>
        </vendor>

        <vendor id="DAS LYZEUM" name=" DER WAHRHEIT HEILER" healer="STARFIRE">
            <service choice="a" name="GIFT KURIEREN" desc="EINE ENTGIFTUNG" price="100" type="cure"/>
            <service choice="b" name="WUNDEN HEILEN" desc="EINE WUNDHEILUNG" price="200" type="fullheal"/>
            <service choice="c" name="TOTE ERWECKEN" desc="EINE ERWECKUNG" price="300" type="resurrect"/>
        </vendor>

        <vendor id="EMPATH-ABTEI" name=" DER LIEBE HEILER" healer="SALLE'">
            <service choice="a" name="GIFT KURIEREN" desc="EINE ENTGIFTUNG" price="100" type="cure"/>
            <service choice="b" name="WUNDEN HEILEN" desc="EINE WUNDHEILUNG" price="200" type="fullheal"/>
            <service choice="c" name="TOTE ERWECKEN" desc="EINE ERWECKUNG" price="300" type="resurrect"/>
        </vendor>

        <vendor id="SCHLANGENFESTE" name=" DES MUTES HEILER" healer="WINDWALKER">
            <service choice="a" name="GIFT KURIEREN" desc="EINE ENTGIFTUNG" price="100" type="cure"/>
            <service choice="b" name="WUNDEN HEILEN" desc="EINE WUNDHEILUNG" price="200" type="fullheal"/>
            <service choice="c" name="TOTE ERWECKEN" desc="EINE ERWECKUNG" price="300" type="resurrect"/>
        </vendor>

        <vendor id="KESSELBUCHT" name="M HEILERLADEN" healer="QUAT">
            <service choice="a" name="GIFT KURIEREN" desc="EINE ENTGIFTUNG" price="100" type="cure"/>
            <service choice="b" name="WUNDEN HEILEN" desc="EINE WUNDHEILUNG" price="200" type="fullheal"/>
            <service choice="c" name="TOTE ERWECKEN" desc="EINE ERWECKUNG" price="300" type="resurrect"/>
        </vendor>

    </script>

    <!--
    /**
     * Inns
     */
    -->
    <script id="Inn" noun="room">
        <intro>
            <music type="shopping"/>
            DER GASTWIRT SAGT: <if test="{party:transport}=horse" redirect="nohorse"/>WILKOMMEN {name}.

            ICH BIN {innkeeper}. BRAUCHST DU UNTERKUNFT?<input type="choice" options="jn" target="ask"/>
        </intro>

        <end>
            <music reset="true"/>
        </end>

        <bye>
            {innkeeper} SAGT: DANN BIST DU HIER FALSCH! GUTEN TAG.
            <end/>
        </bye>
        <nohorse>SCHAFF DAS PFERD HIER RAUS!!!
            <end/>
        </nohorse>
        <ask default="true" redirect="bye"/>
        <ask choice="n" redirect="bye"/>
        <rent default="true" redirect="no_better_deal"/>
        <rent choice="j" redirect="stay"/>
        <rent choice="1" redirect="stay"/>
        <rent choice="2" redirect="stay"/>
        <rent choice="3" redirect="stay"/>

        <no_better_deal>
            IN DIESER STADT FINDEST DU NICHTS G]NSTIGERES!
            <end/>
        </no_better_deal>
        <stay>
            <context name="room"/>
            <pay price="{price}" quantity="1" cantpay="cantpay"/>
            <cursor enable="false"/>
            SEHR GUT. W]NSCHE EINE ANGENEHME NACHT.
            <move x="{x}" y="{y}"/>
            <random chance="25%">
                <wait msecs="2000"/>
                OH, UND K]MMER DICH NICHT UM DIE GER[USCHE, DAS SIND NUR RATTEN!
            </random>
            <sleep/>
            <end/>
        </stay>
        <cantpay>
            KANNST NICHT ZAHLEN, KANNST NICHT BLEIBEN! ADE.
            <end/>
        </cantpay>

        <!-- MOONGLOW -->
        <vendor id="GLIMMEMOND" name="IM EHRLICHEN GASTHOFE" innkeeper="SCATU">
            <room choice="j" price="20" x="28" y="6"/>
            <ask choice="j">
                WIR VERMIETEN EINEN RAUM MIT 2 BETTEN F]R 20gs.

                WILLST DU IHN?<input type="choice" options="jn" target="rent"/>
            </ask>
        </vendor>

        <!-- BRITAIN -->
        <vendor id="BRITAIN" name="IM ANWESEN BRITANNIA" innkeeper="JASON">
            <room choice="j" price="15" x="29" y="6"/>
            <ask choice="j">
                WIR HABEN EINEN RAUM BESCHEIDENER GR\SSE MIT 1 BETT F]R 15gs.

                WILLST DU IHN?<input type="choice" options="jn" target="rent"/>
            </ask>
        </vendor>

        <!-- JHELOM -->
        <vendor id="JHELOM" name="IM GASTHOFE DER ENDEN" innkeeper="SMIRK">
            <room choice="j" price="10" x="10" y="26"/>
            <ask choice="j">
                WIR HABEN EINEN SEHR SICHEREN RAUM, MIT BESCHEIDENER GR\SSE UND 1 BETT, F]R 10gs.

                WILLST DU IHN?<input type="choice" options="jn" target="rent"/>
            </ask>
        </vendor>

        <!-- MINOC -->
        <vendor id="MINOC" name="IN DES WANDERSMANNES GASTHOFE" innkeeper="ESTRO" rooms="3">
            <room choice="1" price="30" x="2" y="6"/>
            <room choice="2" price="60" x="2" y="2"/>
            <room choice="3" price="90" x="8" y="2"/>
            <ask choice="j">
                WIR HABEN DREI R[UME FREI, MIT 1, 2 ODER 3 BETTEN, F]R JE 30, 60 ODER 90 gs.

                1, 2 ODER 3 BETTEN?<input type="choice" options="0123" target="rent"/>
            </ask>
        </vendor>

        <!-- TRINSIC -->
        <vendor id="TRINSIC" name="IM HOTEL HONORIG" innkeeper="ZAJAC">
            <room choice="j" price="15" x="29" y="2"/>
            <ask choice="j">
                WIR HABEN NUR EINEN RAUM, MIT HINTERT]R, F]R 15gs.

                WILLST DU IHN?<input type="choice" options="jn" target="rent"/>
            </ask>
        </vendor>

        <!-- SKARA BRAE -->
        <vendor id="SKARA BRAE" name="IM HOFE DER GEISTER" innkeeper="TYRONE">
            <room choice="j" price="5" x="28" y="11"/>
            <ask choice="j">
                LEIDER HABE ICH NUR EINEN SEHR KLEINEN RAUM MIT 1 BETT; NOCH SCHLIMMER, ES SPUKT DORT! WENN DU BLEIBEN WILLST, KOSTET ES 5gs.

                WILLST DU IHN?<input type="choice" options="jn" target="rent"/>
            </ask>
        </vendor>

        <!-- VESPER -->
        <vendor id="VESPER" name="IM TRAUMLADEN" innkeeper="TYMUS">
            <room choice="j" price="1" x="25" y="23"/>
            <ask choice="j">
                ALLES, WAS WIR HABEN, IST DAS FELDBETT DA DR]BEN. ABER ES IST BEQUEM UND KOSTET NUR 1gs.

                WILLST DU ES?<input type="choice" options="jn" target="rent"/>
            </ask>
        </vendor>
    </script>

    <!--
    /**
     * Guild
     */
    -->
    <script id="Guild" noun="item">
        <intro>
            <music type="shopping"/>
            <ztats screen="equipment"/>
            WAHRSCHAU, MIEN <if test="{party:member1:sex}=m">JONG!</if><if test="{party:member1:sex}=f">DEERN!</if> SICHER WILLST DU VOM ALTEN {ownerdat} KAUFEN!

            {owner} SAGT: WILKOMMEN I{name}.
            WILLST DU MEINE BEUTE SEHEN?<input type="choice" options="jn" target="show_goods"/>
        </intro>

        <end>
            <music reset="true"/>
            <ztats screen="party"/>
        </end>

        <bye>
            {owner} SAGT: AUF BALD, MIEN <if test="{party:member1:sex}=m">JONG!
            </if><if test="{party:member1:sex}=f">DEERN!
            </if>
            <end/>
        </bye>

        <show_goods default="true" redirect="bye"/>
        <show_goods choice="j">
            {owner} SAGT: GUT, MIEN <if test="{party:member1:sex}=m">JONG!
            </if><if test="{party:member1:sex}=f">DEERN!
            </if>
            SCHAU HER, ICH HAB:
            {show_inventory:show_item}
            WAS SOLLS'N SEIN?<input type="choice" options="{inventory_choices}" target="tell_about"/>
        </show_goods>

        <show_item>{toupper({choice})}-{name}</show_item>

        <tell_about default="true" redirect="bye"/>
        <tell_about choice="a">
            <context name="item"/>
            ICH KANN DIR {quant} LANGLEBIGE FACKELN F]R LAUSIGE {price}gs GEBEN.<redirect target="will_buy"/>
        </tell_about>
        <tell_about choice="b">
            <context name="item"/>
            ICH HAB MAGISCHE KARTIERENDE JUWELEN, {quant} F]R NUR {price}gs.<redirect target="will_buy"/>
        </tell_about>
        <tell_about choice="c">
            <context name="item"/>
            MAGISCHE DIETRICHE, EINWEG, MEIN FAIRER PREIS IST {price}gs F]R {quant}.<redirect target="will_buy"/>
        </tell_about>
        <tell_about choice="d">
            <context name="item"/>
            SOSO... DU WILLST 'N SEXTANTEN... NUN, ICH HAB EINEN DA, VON DEM ICH MICH F]R {price}gs TRENNEN K\NNTE!<redirect target="will_buy"/>
        </tell_about>

        <will_buy>
            <var name="item" value="{$choice}"/>
            WILLST DU KAUFEN?<input type="choice" options="jn" target="buy_item"/>
        </will_buy>

        <buy_item default="true" choice="n">
          HMMM... GRUMMEL...
          <redirect target="see_more"/>
        </buy_item>
        <buy_item choice="j">
            <redirect target="buy" choice="{$item}"/>
        </buy_item>

        <buy>
            <pay price="{price}" quantity="1" cantpay="cantpay"/>
            GUT... GUT...
            <add type="{type}" quantity="{quant}"/>
            <redirect target="see_more"/>
        </buy>
        <cantpay>
            WAS? KANNST NICHT ZAHLEN? HAUB AB, SCHWEIN!
            <end/>
        </cantpay>

        <see_more>
            <unset_context/>
            {owner} SAGT: MEHR SEHEN?<input type="choice" options="jn" target="show_goods"/>
        </see_more>

        <vendor id="VESPER" name="M GILDENLADEN" owner="LONG JOHN LEARY" ownerdat="LONG JOHN LEARY">
            <item choice="a" name="FACKELN" price="50" quant="5" type="torch"/>
            <item choice="b" name="JUWELEN" price="60" quant="5" type="gem"/>
            <item choice="c" name="DIETRICHE" price="60" quant="6" type="key"/>
            <item choice="d" hidden="true" name="SEXTANT" price="900" quant="1" type="sextant"/>
        </vendor>

        <vendor id="BUKANIER-NEST" name="N DER PIRATENGILDE" owner="DER EIN[UGIGE WILLEY" ownerdat="EIN[UGIGEN WILLEY">
            <item choice="a" name="FACKELN" price="50" quant="5" type="torch"/>
            <item choice="b" name="JUWELEN" price="60" quant="5" type="gem"/>
            <item choice="c" name="DIETRICHE" price="60" quant="6" type="key"/>
            <item choice="d" hidden="true" name="SEXTANT" price="900" quant="1" type="sextant"/>
        </vendor>
    </script>

    <!--
    /**
     * STABle
     */
    -->
    <script id="Stable">
        <intro>
            <music type="shopping"/>
            WILKOMMEN <if test="{party:member1:sex}=f">FREUNDIN!</if><if test="{party:member1:sex}=m">FREUND!</if> KANN ICH DICH AN PFERDEN INERESSIEREN?<input type="choice" options="jn" target="ask"/>
        </intro>

        <end>
            <music reset="true"/>
        </end>

        <bye>
            EINE SCHANDE, DU SIEHST AUS, ALS WENN DU EIN GUTES PFERD BRAUCHEN KANNST!
            <end/>
        </bye>

        <ask default="true" redirect="bye"/>
        <ask choice="j">
            F]R NUR {price}gs FEST IM SATTEL! WILLST DU KAUFEN?<input type="choice" options="jn" target="buy"/>
        </ask>

        <buy default="true" redirect="bye"/>
        <buy choice="j">
            <pay price="{price}" quantity="1" cantpay="cantpay"/>
            <add type="horse"/>
            HIER, EIN BESSERE RASSE WIRST DU NIEMALS FINDEN!
            <end/>
        </buy>

        <cantpay>
            ES SCHEINT, DU HAST NICHT GENUG GOLD ZUM BEZAHLEN!
            <end/>
        </cantpay>

        <vendor id="PFOTEN" price="{math({party:members}*100)}"/>
    </script>

</scripts>
